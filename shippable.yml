language: python

python:
  - 3.4

install: make deps

services:
  - postgres

env:
  global:
    - DJANGO_SETTINGS_MODULE=tests.ci_settings

build:
  ci:
    # Create folders for test and code coverage
    - mkdir -p shippable/testresults
    - mkdir -p shippable/codecoverage

    - psql -c 'create database pyeti;' -U postgres
    - psql -c 'create user root with superuser;' -U postgres

    # Run test and code coverage and output results to the right folder
    - make test/coverage
    - coverage xml -o shippable/codecoverage/coverage.xml
    - make lint

integrations:
  notifications:
    - integrationName: eti_slack
      type: slack
      recipients:
        - "#activity"
